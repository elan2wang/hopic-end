online anonymity network tor be high-priority target National Security Agency work attack Tor be do NSA application vulnerability branch be part system intelligence directorate SID majority NSA employee work SID be task collect datum communication system world accord top-secret NSA presentation provide whistleblower Edward Snowden successful technique NSA have develop involve exploit tor browser bundle collection program design make easy people install use software trick identify Tor user internet execute attack Firefox web browser NSA refer capability CNE computer network exploitation first step process be find Tor user accomplish NSA rely vast capability monitor large part internet be do agency partnership US telecom firm program codename Stormbrew Fairview Oakstar Blarney NSA create fingerprint detect http request Tor network particular server fingerprint be load NSA database system xkeyscore bespoke collection analysis tool NSA boast allow analyst see everything target do internet use powerful datum analysis tool codename such turbulence turmoil tumult NSA sift enormous amount internet traffic see look Tor connection last month brazilian tv news show Fantastico show screenshot NSA tool have ability identify tor user monitor internet traffic very feature make Tor powerful anonymity service fact tor user look internet make easy differentiate Tor user other web user other hand anonymity provide Tor make impossible NSA know user be user be US identify individual Tor user internet NSA use network secret internet server redirect user set secret internet server codename foxacid infect user computer FoxAcid be NSA system design act matchmaker potential target attack develop NSA give agency opportunity launch prepared attack system computer be attack call FoxAcid server perform additional attack target computer ensure remain compromise long-term continue provide eavesdropping information NSA exploit tor browser bundle tor be well-designed robust anonymity tool attack be difficult NSA attack find target tor user exploit vulnerability Firefox browser Tor application be difficult tor user turn vulnerable service script flash use Tor make difficult target service NSA use series native Firefox vulnerability attack user Tor browser bundle accord training presentation provide Snowden EgotisticalGiraffe exploit type confusion vulnerability e4x be xml extension Javascript vulnerability exist Firefox 창 Firefox esr 창 Firefox version use Tor browser bundle accord document vulnerability exploit EgotisticalGiraffe be fix Mozilla remove e4x library vulnerability Tor add Firefox version Tor browser bundle NSA be confident be able find replacement Firefox exploit work version esr Quantum system trick target visit FoxAcid server NSA rely secret partnership US telecom company part turmoil system NSA place secret server codename Quantum key place internet backbone placement ensure react faster other website exploit speed difference server impersonate visit website target legitimate website respond trick target browser visit foxacid server academic literature be call man-in-the-middle attack have be know commercial academic security community be example man-on-the-side attack be hard organization other NSA execute require attacker have privileged position internet backbone exploit race condition NSA server legitimate website top-secret NSA diagram make public last month show Quantum server impersonate Google type attack NSA use fast Quantum server execute packet injection attack redirect target FoxAcid server article german magazine Spiegel base additional top secret Snowden document mention NSA develop attack technology name QuantumInsert perform redirection attack top-secret tor presentation provide Snowden mention QuantumCookie force cookie target browser Quantum program degrade\/deny\/disrupt tor access same technique be use chinese government block citizen read censor internet content have be hypothesize probable NSA attack technique foxacid system accord various top-secret document provide Snowden FoxAcid be NSA codename NSA call exploit orchestrator internet-enabled system capable attack target computer variety different way be Windows computer configure custom software series Perl script server be run NSA tailor access operation TAO group TAO be subgroup system intelligence directorate server be public internet have normal-looking domain name be visit browser ownership domain be trace NSA browser try visit FoxAcid server special url call FoxAcid tag server attempt infect browser computer effort take control NSA trick browser use url use variety method include race-condition attack mention frame injection attack foxacid tag be design look innocuous anyone see be suspicious example such tag link remove be give top-secret training presentation provide Snowden be register domain name name be example internal NSA training purpose training material state try visit homepage real FoxAcid server result attack specialize url be require url be create TAO specific NSA operation unique operation target allow FoxAcid server know target be computer contact accord Snowden FoxAcid be general cne system use many type attack other tor attack describe be design be modular flexibility allow TAO swap replace exploit be discover run certain exploit certain type target valuable exploit be save important target low-value exploit be run sophisticated target chance detection be high TAO maintain library exploit base different vulnerability system different exploit be authorize different target depend value target target technical sophistication value exploit other consideration case tor user foxacid use EgotisticalGiraffe Firefox browser accord top-secret operational management procedure manual provide Snowden target be exploit be infect several payload basic payload mention manual be design collect configuration location information target computer analyst determine further infect computer decision be make part technical sophistication target security software install target computer call Personal Security Products PSP manual FoxAcid payload be update TAO example manual refer version 8.2.1.1 foxacid server have sophisticated capability avoid detection ensure successful infection target operation manual state FoxAcid payload codename DireScallop circumvent commercial product prevent malicious software make change system survive reboot process NSA use phishing attack induce user click foxacid tag TAO use foxacid exploit callback 창 be general term computer infect automatic means 창 call NSA instruction upload datum target computer accord top-secret operational management procedure manual foxacid server configure receive callback be codename FrugalShot callback FoxAcid server run more exploit ensure target computer remain compromise long term install implant design exfiltrate datum NSA be get much foxacid callback datum need build special system manage 