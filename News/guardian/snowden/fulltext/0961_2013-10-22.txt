The Guardian offices in London. Julian Smith MP has called for the newspaper to be prosecuted for its coverage of the NSA files leaked by Edward Snowden Photograph: David Levene A Conservative MP has attacked the Guardian for publishing stories about mass surveillance by the security services based on leaks from the US whistleblower Edward Snowden. Speaking in parliament Julian Smith, MP for Skipton and Ripon, said that the newspaper had broken the law and should be prosecuted.But Smith's address was condemned as McCarthyism and "absolute scaremongering" by Labour MPs who were prevented from making speeches. Several MPs criticised the format of the parliamentary debate as they were denied an opportunity to intervene while Smith read out his speech and then the Home Office minister James Brokenshire gave the government's view that the Guardian's publication of the Snowden leaks had damaged national security. Smith had called the debate in Westminster Hall to raise concerns in parliament about the way the Guardian handled the Snowden files. The backbencher, who made a complaint about the Guardian to the police, criticised the newspaper for writing stories "with no consultation with government". He said: "In spite of the actions taken by the government to destroy the files held in the Guardian's London office, these files are out there, highly vulnerable to terrorist infiltration, and not just that â these detailed files on GCHQ operations are now handed to an infinite number of extra eyes via American journalists and even bloggers. Each person multiplies the risk to this country. The Guardian focused on sending abroad revelations not about the American NSA or whistleblowing. They chose to distribute information about our own intelligence agents and GCHQ â¦ To communicate, not just publish, any identifying information about GCHQ personnel is a terrorist offence. This is not press freedom â this is the Guardian's devastating impact on national security." Smith's allegations were challenged by a number of Labour and Tory MPs. David Davis, a former Tory leadership candidate, and Dominic Raab, MP for Esher and Walton, asked why, if there had been harm to national security, there had been no charges against anyone related to the Guardian. Denied the chance to intervene, Paul Flynn, Labour MP for Newport West, asked why he was barred making a short speech."This is a piece of McCarthyite scaremongering and it disgraces parliament." David Winnick, MP for Walsall North, was forced to use a technical point of order to get his point across. He said: "A lot of what appeared in the Guardian that has been the subject of this debate has made certainly the US go into a wide-ranging inquiry into intelligence gathering, and what the Guardian has published has certainly been in the public interest." He later called the debate disgraceful saying the minister read his speech like a robot. However, Smith was backed by Julian Lewis, a member of the Commons intelligence and security committee, who said he would expect to be charged if he had released information as the Guardian had done. Brokenshire, for the government, said he wanted to highlight the "huge damage to national security caused by reporting attributed to the highly classified material stolen by Edward Snowden". He added: "There is no doubt Snowden's actions and publication of material stolen by him have damaged UK national security." Brokenshire said: "I cannot go into more detail of the damage done and the future damage. But we expect to lose coverage of some very dangerous individuals and groups." On Tuesday a spokesperson for Guardian News & Media said Smith's speech "propagated a series of myths" about the Guardian's reporting of the Snowden documents. "When responsible journalists working on the same story share documents they are engaged in journalism not terrorism. Senior politicians and government officials in the UK and internationally, over 30 of the world's leading newspaper editors, and an overwhelming majority of the public, have all said that the Guardian's reporting on this story is important for democracy." She added: "They all agree, as does Mr Smith, that surveillance of citizens by intelligence agencies is a legitimate subject for debate. But there would be no public debate had there been no disclosure." Davis suggested Smith should be more concerned that UK government secrets were "accessible to hundreds of thousands of US government employees", including Snowden, if he was so worried about national security. Paul Farrelly, Labour MP for Newcastle-Under-Lyme, said he wanted it put on the record that "none other than Obama has said some of these disclosures raise legitimate questions for our friends and allies about how these capabilities are employed". He also said the attack on the Guardian was "in danger of being misinterpreted potentially as joining the war of the Mail and other people, all because of its pursuit of phone hacking". Smith denied those accusations.